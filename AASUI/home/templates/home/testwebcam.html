{% extends 'home/main.html' %}


{% block content %}

	<style type="text/css">
		body { font-family: Helvetica, sans-serif; }
		h2, h3 { margin-top:0; }
		form { margin-top: 15px; }
		form > input { margin-right: 15px; }
		#results { float:right; margin:20px; padding:20px; border:1px solid; background:#ccc; }
	</style>

	<div id="results">Your captured image will appear here...</div>


	<div id="my_camera"></div>

	<!-- First, include the Webcam.js JavaScript Library -->
	{% load staticfiles %}
	<script type="text/javascript" src='{% static "home/js/webcam.js" %}'></script>

	<!-- Configure a few settings and attach camera -->
	<script language="JavaScript">
/*	Webcam.set({
			force_flash: true
}); usingFlashPlayer*/
		Webcam.set({
			width: 320,
			height: 240,
			image_format: 'jpeg',
			jpeg_quality: 90
		});
		Webcam.attach( '#my_camera' );
	</script>

	<!-- A button for taking snaps -->
	<form name="takesnapshot" id="takesnapshot">
		<input type=button value="Stop Snapshot" onClick="stop_snapshot()">
	</form>
	<form name="takesnapshot" id="takesnapshot">
 		<input type=button value="Start Snapshot" onClick="start_snapshot()">
 	</form>
	<!-- Code to handle taking the snapshot and displaying it locally -->
	<script language="JavaScript">

   var hk=true;
   function stop_snapshot() {
   	hk=false;
   }
	 function start_snapshot() {
		 hk=true;
		 take_snapshot();
	 }

		function take_snapshot() {
			// take snapshot and get image data
			Webcam.snap( function(data_uri) {

				document.getElementById('results').innerHTML = '<h2>sending Image to server:</h2>' +
					'<img src="'+data_uri+'"/>';
           Webcam.upload( data_uri, "/webcamimage/",function(code, text) {

              if(hk){
								 t=setTimeout(take_snapshot,1000);
							}
					 });
        } );

		}
    setTimeout(take_snapshot,1000);
	</script>
{% endblock %}
